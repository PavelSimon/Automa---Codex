{% extends 'base.html' %}
{% block content %}
<section>
  <h2>Prihlásenie / Registrácia</h2>
  <div class="grid2">
    <form action="/ui/auth/login" method="post" hx-post="/ui/auth/login" hx-target="#login-status" hx-swap="outerHTML">
      <label>Email <input type="email" name="email" value="admin@example.com" autocomplete="email" required /></label>
      <label>Heslo <input type="password" name="password" value="admin" autocomplete="current-password" required /></label>
      <button type="submit">Prihlásiť</button>
      <span id="login-status" hx-get="/ui/partials/login_status" hx-trigger="load" hx-swap="outerHTML">&nbsp;</span>
    </form>
    <form action="/ui/auth/register" method="post" hx-post="/ui/auth/register" hx-target="#login-status" hx-swap="outerHTML">
      <label>Email <input type="email" name="email" placeholder="novy@example.com" autocomplete="email" required /></label>
      <label>Meno <input type="text" name="full_name" placeholder="Celé meno" autocomplete="name" /></label>
      <label>Heslo <input type="password" name="password" autocomplete="new-password" required /></label>
      <button type="submit">Registrovať</button>
    </form>
  </div>
</section>

{% if user %}
<section>
  <h2>Profil</h2>
  <div id="profile" hx-get="/ui/partials/profile" hx-trigger="load" hx-swap="outerHTML">Načítavam…</div>
</section>

{% if user.is_admin %}
<section>
  <h2>Agenti</h2>
  <form hx-post="/ui/agents" hx-target="#agents-list" hx-swap="outerHTML">
    <input type="text" name="name" placeholder="názov agenta" required />
    <input type="text" name="description" placeholder="popis" />
    <button type="submit">Vytvoriť</button>
  </form>
  <div id="agents-list" hx-get="/ui/partials/agents" hx-trigger="load" hx-swap="outerHTML">Načítavam…</div>
</section>

<section>
  <h2>Skripty</h2>
  <form hx-post="/ui/scripts" hx-target="#scripts-list" hx-swap="outerHTML">
    <input type="text" name="name" placeholder="názov skriptu" required />
    <input type="text" name="path" placeholder="cesta k skriptu" required />
    <input type="text" name="description" placeholder="popis" />
    <button type="submit">Vytvoriť</button>
  </form>
  <div id="scripts-list" hx-get="/ui/partials/scripts" hx-trigger="load" hx-swap="outerHTML">Načítavam…</div>
</section>
{% endif %}

<section>
  <h2>Joby</h2>
  <form hx-post="/ui/jobs" hx-target="#jobs-list" hx-swap="outerHTML">
    <input type="number" name="script_id" placeholder="script_id (voliteľné)" />
    <input type="datetime-local" name="when" />
    <button type="submit">Naplánovať</button>
  </form>
  <div id="jobs-list" hx-get="/ui/partials/jobs" hx-trigger="load" hx-swap="outerHTML">Načítavam…</div>
</section>
{% else %}
<section>
  <div class="warn">Obsah je dostupný až po prihlásení.</div>
  <div>Prihlás sa v sekcii vyššie.</div>
</section>
{% endif %}
{% endblock %}
